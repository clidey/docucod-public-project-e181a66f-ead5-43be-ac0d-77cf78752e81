---
title: "Integration with GORM"
description: "Explains how Hints is incorporated using the `Clauses` mechanism in GORM, and what steps are required for setup. Summarizes compatibility and extension model for users unfamiliar with GORM Clause extensions."
---

# Integration with GORM

Discover how the Hints extension seamlessly integrates with GORM by leveraging the powerful `Clauses` mechanism. This page walks you through the setup process, compatibility considerations, and the underlying clause-based extension model that enables flexible, precise injection of SQL optimizer hints, index hints, and comments into your GORM queries.

---

## Why Integration Matters

Your goal as a developer is to gain fine-grained control over the SQL generated by GORM without sacrificing the ease and expressiveness of its ORM interface. The Hints extension accomplishes this by hooking into GORM's existing clause infrastructure. This means your hints are applied at the exact point in the query lifecycle where they belong — whether that's inside a SELECT statement, an UPDATE, or alongside JOIN clauses.

This design ensures your queries remain idiomatic, maintainable, and compatible with GORM's conventions and ecosystem.

---

## How Hints Integrates Using GORM Clauses

Hints are incorporated through GORM’s `Clauses` feature, which allows you to augment or override specific parts of a SQL query. Instead of manually modifying the query string, you pass Hints instances as clauses when building your database operations:

```go
import "gorm.io/hints"

// Apply a simple optimizer hint
DB.Clauses(hints.New("MAX_EXECUTION_TIME(100)")).Find(&User{})
// Results in: SELECT /*+ MAX_EXECUTION_TIME(100) */ * FROM `users`
```

### Key Points About Clause Integration

- **General Clause Injection:** Hints implement the `Modifier` interface to insert themselves as expressions within GORM's clauses.
- **Clause Targeting:** You specify the clauses where hints are injected (e.g., SELECT, UPDATE) via internal mappings.
- **Before and After Injection:** Some hints can be configured to appear before or after specific clauses, controlling exact SQL comment placement.
- **Multiple Hints Merged:** When multiple hints apply to the same clause, they merge gracefully, combining content with appropriate spacing.

---

## Setting Up Hints in Your GORM Project

Integration requires minimal setup as Hints is designed as a drop-in extension.

### Step 1: Import the Hints Package

Add the hints module to your Go project and import it:

```go
import "gorm.io/hints"
```

### Step 2: Use Hints with Clauses

Apply hints directly in your queries using `DB.Clauses()`:

```go
// Example: Using an optimizer hint
DB.Clauses(hints.New("USE_INDEX(t1, idx1)")).Find(&User{})

// Example: Comment hint before a SELECT
DB.Clauses(hints.CommentBefore("select", "important query")).Find(&User{})
```

### Step 3: Combine Multiple Hints

Chain multiple clauses seamlessly to enhance your query:

```go
DB.Clauses(
  hints.New("MAX_EXECUTION_TIME(100)"),
  hints.UseIndex("user_name"),
).Find(&User{})
```

This will produce:

```sql
SELECT /*+ MAX_EXECUTION_TIME(100) */ * USE INDEX (`user_name`) FROM `users`
```

---

## Compatibility and Extension Model

Hints respects GORM’s broad database compatibility by operating at the clause level rather than manipulating raw SQL strings. This abstraction allows it to:

- Work transparently with various GORM-supported databases.
- Support major SQL clause types including `SELECT`, `UPDATE`, `FROM`, `WHERE`, and more.
- Extend index hints to `FROM` and `UPDATE` clauses for precise indexing strategies.

### Extension via Clause Interfaces

The core mechanism relies on implementing the `ModifyStatement` method to inject hints during SQL building. For example, the optimizer hints define themselves with:

```go
func (hints Hints) ModifyStatement(stmt *gorm.Statement) {
  // Logic to attach hints to specified clauses
}
```

This design lets you extend or customize how hints apply if you develop additional integrations or advanced features.

---

## Example Walkthrough: Using Multiple Hint Types

Here’s a practical example that combines optimizer hints, index hints, and comment hints using clauses:

```go
result := DB.Clauses(
  hints.New("MAX_EXECUTION_TIME(100)"),        // Optimizer hint
  hints.UseIndex("idx_user_name"),             // Index hint
  hints.Comment("select", "tracking=enabled"), // Inline comment hint
).Find(&User{})

// Generates:
// SELECT /*+ MAX_EXECUTION_TIME(100) */ /* tracking=enabled */ * USE INDEX (`idx_user_name`) FROM `users`
```

This example shows how the integration model centralizes multiple hint types without conflict.

---

## Common Pitfalls and Best Practices

- **Clause Targeting Matters:** Always use the correct clause name (e.g., "select", "update") when creating comment hints to ensure proper placement.
- **Merging Hints:** When applying multiple hints on a single query, use separate `hints.` calls combined in `Clauses()` to avoid unintentional content overwrites.
- **Join Queries:** Use index hints that explicitly support join conditions via methods like `.ForJoin()` to ensure your hints apply correctly on JOINS.
- **Testing:** Use GORM’s DryRun mode to verify generated SQL before applying queries.

---

## Summary Diagram: Integration Flow

```mermaid
graph TD
  UserQuery["User Query (gorm.DB)" ] -->|Calls| GORMClause["GORM Clause Processing"]
  GORMClause -->|Inject Hints via ModifyStatement| HintsClause["Hints Clause (Optimizer/Index/Comment)"]
  HintsClause -->|Build SQL Snippet| SQLBuilder["SQL Builder"]
  SQLBuilder --> FinalSQL["Generated SQL with Hints"]
  FinalSQL --> Database["Target Database"]

  %% Notes
  classDef gorm fill:#e2f0fb,stroke:#3182ce,stroke-width:2px
  class UserQuery,GORMClause gorm
  classDef hint fill:#fef3c7,stroke:#d69e2e,stroke-width:2px
  class HintsClause hint
  class SQLBuilder,FinalSQL,Database
```

---

## Next Steps

- Explore the [Quick Feature Overview](/overview/introduction-and-value/quick-feature-overview) for a high-level understanding of hints types.
- Deepen your knowledge with [Core Concepts and Terminology](/overview/core-concepts-and-architecture/domain-terminology).
- Begin practical application by following the [Getting Started guides](/getting-started/setup-installation/prerequisites).

By mastering how hints integrate with GORM, you unlock powerful SQL tuning capabilities that enhance performance and control without disrupting your existing workflow.

---

## Troubleshooting Tips

<AccordionGroup title="Common Integration Issues">
<Accordion title="Hints Not Appearing in SQL">
Check that the hints are correctly added to the query using `DB.Clauses()`. Verify clause names (like "select" or "update") match required case-insensitively and ensure you are running in DryRun mode or logging the SQL.
</Accordion>
<Accordion title="Conflicting or Overwritten Hints">
When combining multiple hints, provide each hint in its own clause entry rather than concatenating strings manually. The extension merges hints content safely.
</Accordion>
<Accordion title="Index Hints Not Applied on Joins">
Use the `.ForJoin()` modifier on index hints to target join conditions accurately. Otherwise, the hint might not appear in joined table clauses.
</Accordion>
</AccordionGroup>

---

## Reference Code Snippet: Using Clauses with Hints

```go
// Simple optimizer hint
DB.Clauses(hints.New("MAX_EXECUTION_TIME(100)")).Find(&User{})

// Using index hint for join
DB.Clauses(hints.ForceIndex("user_name").ForJoin()).Joins("Company").Find(&User{})

// Comment hint before SELECT
DB.Clauses(hints.CommentBefore("select", "important debug info")).Find(&User{})
```

---

For the full set of supported hints and extension points, refer to the detailed API documentation in the [Core Hint Clauses](/api-reference/core-hint-clauses/optimizer-hints) and [Advanced Usage & Integration](/api-reference/advanced-usage-and-integration/chaining-and-combining-hints) sections.


---

  
